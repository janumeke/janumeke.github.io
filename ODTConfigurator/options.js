var PRODUCT_ID = {
    default: "Microsoft 365",
    "Microsoft 365": {
        value: "O365",
        options: {
            default: "Home Premium",
            "Enterprise": "ProPlusRetail",
            "Business": "BusinessRetail",
            "Home Premium": "HomePremRetail",
        }
    },
    "Office Small Business Premium": "SmallBusPremRetail",
    "Office Home & Student": {
        value: "HomeStudent",
        options: {
            default: "",
            "": "Retail",
            "2019": "2019Retail",
            "2021": "2021Retail",
        }
    },
    "Office Home & Business": {
        value: "HomeBusiness",
        options: {
            default: "",
            "": "Retail",
            "2019": "2019Retail",
            "2021": "2021Retail",
        }
    },
    "Office Personal": {
        value: "Personal",
        options: {
            "2019": "2019Retail",
            "2021": "2021Retail",
        }
    },
    "Office Professional": {
        value: "Professional",
        options: {
            default: "",
            "": "Retail",
            "2019": "2019Retail",
            "2021": "2021Retail",
        }
    },
    "Office Standard": {
        value: "Standard",
        options: {
            "2019": "2019Volumn",
            "2021": "2021Volumn",
            "SPLA 2021": "SPLA2021Volumn",
        }
    },
    "Office Professional Plus": {
        value: "ProPlus",
        options: {
            "2019": {
                value: "2019",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
            "2021": {
                value: "2021",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
            "SPLA 2021": "SPLA2021Volumn",
        }
    },
    "Visio": {
        value: "Visio",
        options: {
            "Professional": {
                value: "Pro",
                options: {
                    default: "",
                    "": "Retail",
                    "X": "XVolumn",
                    "2019": {
                        value: "2019",
                        options: {
                            "Retail": "Retail",
                            "Volumn": "Volumn",
                        }
                    },
                    "2021": {
                        value: "2021",
                        options: {
                            "Retail": "Retail",
                            "Volumn": "Volumn",
                        }
                    },
                }
            },
            "Standard": {
                value: "Std",
                options: {
                    default: "",
                    "": "Retail",
                    "X": "XVolumn",
                    "2019": {
                        value: "2019",
                        options: {
                            "Retail": "Retail",
                            "Volumn": "Volumn",
                        }
                    },
                    "2021": {
                        value: "2021",
                        options: {
                            "Retail": "Retail",
                            "Volumn": "Volumn",
                        }
                    },
                }
            },
        }
    },
    "Project": {
        value: "Project",
        options: {
            "Professional": {
                value: "Pro",
                options: {
                    default: "",
                    "": "Retail",
                    "X": "XVolumn",
                    "2019": {
                        value: "2019",
                        options: {
                            "Retail": "Retail",
                            "Volumn": "Volumn",
                        }
                    },
                    "2021": {
                        value: "2021",
                        options: {
                            "Retail": "Retail",
                            "Volumn": "Volumn",
                        }
                    },
                }
            },
            "Standard": {
                value: "Std",
                options: {
                    default: "",
                    "": "Retail",
                    "X": "XVolumn",
                    "2019": {
                        value: "2019",
                        options: {
                            "Retail": "Retail",
                            "Volumn": "Volumn",
                        }
                    },
                    "2021": {
                        value: "2021",
                        options: {
                            "Retail": "Retail",
                            "Volumn": "Volumn",
                        }
                    },
                }
            },
        }
    },
    "Access": {
        value: "Access",
        options: {
            default: "",
            "Runtime": "RuntimeRetail",
            "": "Retail",
            "2019": {
                value: "2019",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
            "2021": {
                value: "2021",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
        }
    },
    "Excel": {
        value: "Excel",
        options: {
            default: "",
            "": "Retail",
            "2019": {
                value: "2019",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
            "2021": {
                value: "2021",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
        }
    },
    "Outlook": {
        value: "Outlook",
        options: {
            default: "",
            "": "Retail",
            "2019": {
                value: "2019",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
            "2021": {
                value: "2021",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
        }
    },
    "PowerPoint": {
        value: "PowerPoint",
        options: {
            default: "",
            "": "Retail",
            "2019": {
                value: "2019",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
            "2021": {
                value: "2021",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
        }
    },
    "Publisher": {
        value: "Publisher",
        options: {
            default: "",
            "": "Retail",
            "2019": {
                value: "2019",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
            "2021": {
                value: "2021",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
        }
    },
    "Word": {
        value: "Word",
        options: {
            default: "",
            "": "Retail",
            "2019": {
                value: "2019",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
            "2021": {
                value: "2021",
                options: {
                    "Retail": "Retail",
                    "Volumn": "Volumn",
                }
            },
        }
    },
    "OneNote": {
        value: "OneNote",
        options: {
            default: "",
            "Free": "FreeRetail",
            "": "Retail",
            "2021": "2021Volumn",
        }
    },
    "Skype": {
        value: "Skype",
        options: {
            "Business": {
                value: "forBusiness",
                options: {
                    "2016": "Retail",
                    "2019": {
                        value: "2019",
                        options:{
                            "Retail": "Retail",
                            "Volumn": "Volumn",
                        }
                    },
                    "LTSC 2021": "2021Volumn",
                }
            },
            "Business Basic": {
                value: "forBusinessEntry",
                options: {
                    "2016": "Retail",
                    "2019": "2019Retail",
                }
            },
        }
    },
};

var LANGUAGE_ID = {
    "Match OS": "MatchOS",
    "Match Previous MSI": "MatchPreviousMSI",
    "Match Installed": "MatchInstalled",
    "Afrikaans": "af-ZA",
    "Albanian": "sq-AL",
    "Arabic": "ar-SA",
    "Armenian": "hy-AM",
    "Assamese": "as-IN",
    "Azerbaijani (Latin)": "az-Latn-AZ",
    "Bangla (Bangladesh)": "bn-BD",
    "Bangla (Bengali India)": "bn-IN",
    "Basque (Basque)": "eu-ES",
    "Bosnian (Latin)": "bs-latn-BA",
    "Bulgarian": "bg-BG",
    "Catalan": "ca-ES",
    "Catalan (Valencia)": "ca-ES-valencia",
    "Chinese (Simplified)": "zh-CN",
    "Chinese (Traditional)": "zh-TW",
    "Croatian": "hr-HR",
    "Czech": "cs-CZ",
    "Danish": "da-DK",
    "Dutch": "nl-NL",
    "English": "en-US",
    "English UK": "en-GB",
    "Estonian": "et-EE",
    "Finnish": "fi-FI",
    "French": "fr-FR",
    "French Canada": "fr-CA",
    "Galician": "gl-ES",
    "Georgian": "ka-GE",
    "German": "de-DE",
    "Greek": "el-GR",
    "Gujarati": "gu-IN",
    "Hausa": "ha-Latn-NG",
    "Hebrew": "he-IL",
    "Hindi": "hi-IN",
    "Hungarian": "hu-HU",
    "Icelandic": "is-IS",
    "Igbo": "ig-NG",
    "Indonesian": "id-ID",
    "Irish": "ga-IE",
    "isiXhosa": "xh-ZA",
    "isiZulu": "zu-ZA",
    "Italian": "it-IT",
    "Japanese": "ja-JP",
    "Kannada": "kn-IN",
    "Kazakh": "kk-KZ",
    "Kinyarwanda": "rw-RW",
    "KiSwahili": "sw-KE",
    "Konkani": "kok-IN",
    "Korean": "ko-KR",
    "Kyrgyz": "ky-KG",
    "Latvian": "lv-LV",
    "Lithuanian": "lt-LT",
    "Luxembourgish": "lb-LU",
    "Macedonian (North Macedonia)": "mk-MK",
    "Malay (Latin)": "ms-MY",
    "Malayalam": "ml-IN",
    "Maltese": "mt-MT",
    "Maori": "mi-NZ",
    "Marathi": "mr-IN",
    "Nepali": "ne-NP",
    "Norwegian BokmÃ¥l": "nb-NO",
    "Norwegian Nynorsk": "nn-NO",
    "Odia": "or-IN",
    "Pashto": "ps-AF",
    "Persian (Farsi)": "fa-IR",
    "Polish": "pl-PL",
    "Portuguese (Portugal)": "pt-PT",
    "Portuguese (Brazil)": "pt-BR",
    "Punjabi (Gurmukhi)": "pa-IN",
    "Romanian": "ro-RO",
    "Romansh": "rm-CH",
    "Russian": "ru-RU",
    "Scottish Gaelic": "gd-GB",
    "Serbian (Cyrillic, Serbia)": "sr-cyrl-RS",
    "Serbian (Latin, Serbia)": "sr-latn-RS",
    "Serbian (Cyrillic, Bosnia & Herzegovina)": "sr-cyrl-BA",
    "Sesotho sa Leboa": "nso-ZA",
    "Setswana": "tn-ZA",
    "Sinhala": "si-LK",
    "Slovak": "sk-SK",
    "Slovenian": "sl-SI",
    "Spanish": "es-ES",
    "Spanish Mexico": "es-MX",
    "Swedish": "sv-SE",
    "Tamil": "ta-IN",
    "Tatar (Cyrillic)": "tt-RU",
    "Telugu": "te-IN",
    "Thai": "th-TH",
    "Turkish": "tr-TR",
    "Ukrainian": "uk-UA",
    "Urdu": "ur-PK",
    "Uzbek (Latin)": "uz-Latn-UZ",
    "Vietnamese": "vi-VN",
    "Welsh": "cy-GB",
    "Wolof": "wo-SN",
    "Yoruba": "yo-NG",
};

function FillSelectWithOptions(selectElement, optionsData){
    for(let key in optionsData){
        if(key == "default")
            continue;
        
        const option = new Option(key, key);
        option.selected = key == optionsData.default;
        selectElement.add(option);
    }
}

function RefreshSubSelect(selectElement, optionsData){
    while(selectElement.nextElementSibling != null && selectElement.nextElementSibling.tagName == "SELECT")
        selectElement.nextElementSibling.remove();
    if(typeof optionsData[selectElement.value] == "object")
        CreateSelectWithChangeEvent(optionsData[selectElement.value].options, selectElement);
}

function CreateSelectWithChangeEvent(optionsData, afterElement){
    const select = document.createElement("select");
    FillSelectWithOptions(select, optionsData);
    afterElement.after(select);

    select.addEventListener("change", () => RefreshSubSelect(select, optionsData));
    RefreshSubSelect(select, optionsData)
}

document.addEventListener("DOMContentLoaded", () => {
    const productSelect = document.querySelector("#productID");
    FillSelectWithOptions(productSelect, PRODUCT_ID);
    productSelect.addEventListener("change", () => RefreshSubSelect(productSelect, PRODUCT_ID));
    RefreshSubSelect(productSelect, PRODUCT_ID);

    FillSelectWithOptions(document.querySelector("#languageID"), LANGUAGE_ID);
});